---
title: "R Notebook"
output: html_notebook
---

## imports

```{r}
library(tidyverse)
library(lme4)
library(lmerTest)
```

## nested model comparison

```{r}
d <- read_csv('./photodraw_tracing.csv') %>%
  mutate(tracing_item = factor(tracing_item, levels = c('this square', 'this shape', 'this circle'))) 
  # mutate(age = scale(age, center = TRUE, scale = FALSE),
  #        post_mse = scale(post_mse, center = TRUE, scale = FALSE))
m1 = lmer(post_mse ~ age + (1 | session_id), data=d)
m2 = lmer(post_mse ~ age + (1 | session_id) + (1 | tracing_item), data=d)
m3 = lmer(post_mse ~ age + tracing_item + (1 | session_id), data=d)
m4 = lmer(post_mse ~ age + (1 | session_id) + (1 + age | tracing_item), data=d)
anova(m1, m2, m3, m4)
```

## Look at interactiosn between age and tracing item

```{r}
# contrasts(d$tracing_item) <- contr.treatment(3, base = 1)
# summary(lmer(post_mse ~ age * tracing_item + (1 | session_id), data=d))
```

## Look at best model 

```{r}
summary(m3)
```

## Visualize data

```{r}
d %>%
  gather(registration, val, pre_mse, post_mse) %>%
  ggplot(aes(x = age, y = val, color = tracing_item)) +
    geom_point() +
    geom_smooth(method = 'lm') +
    facet_wrap(~ registration) +
    theme_bw() +
    theme(aspect.ratio = 1) 
```

```{r}
d %>%
  gather(transformation, val, rotate, translate) %>%
  ggplot(aes(x = age, y = val, color = tracing_item)) +
    geom_point() +
    geom_smooth(method = 'lm') +
    facet_wrap(~ transformation) +
    theme_bw() +
    theme(aspect.ratio = 1) +
    ylim(-0.05, 0.4)

```
